# ES業務フロー - データモデル定義\n\n本ドキュメントでは、ES業務システムで扱う主要なデータの構造と、エンティティ間の関連性を定義します。\n\n## 1. 主要エンティティ一覧\n\nシステムで管理する主要なエンティティは以下の通りです。\n\n*   **User**: システム利用者\n*   **Customer**: 顧客情報\n*   **Partner**: 提携企業情報\n*   **Case**: 案件情報\n*   **Document**: 書類情報\n*   **Schedule**: スケジュール情報\n\n## 2. エンティティ詳細\n\n各エンティティの属性とデータ型、概要を定義します。\n\n### User (システム利用者)\n\nシステムにログインするユーザーの情報を管理します。\n\n| 属性名          | データ型      | 制約    | 概要                     |\n|---------------|-------------|-------|------------------------|\n| user_id       | UUID/Integer | PK    | ユーザーを一意に識別するID      |\n| employee_number| String      | Unique| 社員番号 (ログインIDとして使用)|\n| password_hash | String      |       | パスワードのハッシュ値         |\n| user_name     | String      |       | 氏名                     |\
| role          | Enum (Role) |       | 役割 (e.g., Sales, HQ)   |\n| status        | Enum (Status)|       | アカウント状態             |\n| created_at    | Timestamp   |       | 作成日時                 |\n| updated_at    | Timestamp   |       | 更新日時                 |\n| is_first_login| Boolean     |       | 初回ログインフラグ         |\n\n### Customer (顧客情報)\n\n顧客に関する情報を管理します。\n\n| 属性名          | データ型      | 制約 | 概要           |\n|---------------|-------------|----|--------------|\n| customer_id   | UUID/Integer | PK | 顧客を一意に識別するID |\n| customer_name | String      |    | 顧客名         |\n| contact_info  | JSON/String |    | 連絡先情報     |\n| address       | String      |    | 住所           |\n| industry      | String      |    | 業種           |\n| created_at    | Timestamp   |    | 作成日時       |\n| updated_at    | Timestamp   |    | 更新日時       |\n\n### Partner (提携企業情報)\n\n提携企業に関する情報を管理します。\n\n| 属性名          | データ型      | 制約 | 概要           |\n|---------------|-------------|----|--------------|\n| partner_id    | UUID/Integer | PK | 提携企業を一意に識別するID |\n| partner_name  | String      |    | 提携企業名     |\n| contact_info  | JSON/String |    | 連絡先情報     |\n| address       | String      |    | 住所           |\n| created_at    | Timestamp   |    | 作成日時       |\n| updated_at    | Timestamp   |    | 更新日時       |\n\n### Case (案件情報)\n\nES案件に関する情報を管理します。\n\n| 属性名          | データ型      | 制約    | 概要                 |\n|---------------|-------------|-------|--------------------|\n| case_id       | UUID/Integer | PK    | 案件を一意に識別するID     |\n| case_name     | String      |       | 案件名               |\n| customer_id   | UUID/Integer | FK    | 関連する顧客のID         |\n| partner_id    | UUID/Integer | FK?   | 関連する提携企業のID (任意)|\n| status        | Enum (Status)|       | 案件ステータス         |\n| description   | Text        |       | 案件概要             |\n| created_by    | UUID/Integer | FK    | 案件作成者のユーザーID     |\n| assigned_to   | UUID/Integer | FK?   | 担当者のユーザーID (任意)  |\n| created_at    | Timestamp   |       | 作成日時             |\n| updated_at    | Timestamp   |    | 更新日時             |\n\n### Document (書類情報)\n\n案件に関連する書類情報を管理します。\n\n| 属性名          | データ型      | 制約 | 概要                 |\n|---------------|-------------|----|--------------------|\n| document_id   | UUID/Integer | PK | 書類を一意に識別するID     |\n| case_id       | UUID/Integer | FK | 関連する案件のID         |\n| document_type | Enum (Type) |    | 書類種別 (e.g., Contract)|\n| file_path     | String      |    | ファイル保存場所/パス    |\n| status        | Enum (Status)|    | 書類ステータス         |\n| created_by    | UUID/Integer | FK | 作成者のユーザーID       |\n| created_at    | Timestamp   |    | 作成日時             |\n| updated_at    | Timestamp   |    | 更新日時             |\n\n### Schedule (スケジュール情報)\n\n案件や顧客に関連するスケジュールを管理します。\n\n| 属性名          | データ型      | 制約 | 概要           |\n|---------------|-------------|----|--------------|\n| schedule_id   | UUID/Integer | PK | スケジュールを一意に識別するID |\n| case_id       | UUID/Integer | FK?| 関連する案件のID (任意)  |\n| customer_id   | UUID/Integer | FK?| 関連する顧客のID (任意)  |\n| title         | String      |    | タイトル         |\n| description   | Text        |    | 詳細           |\n| start_time    | Timestamp   |    | 開始日時         |\n| end_time      | Timestamp   |    | 終了日時         |\n| created_by    | UUID/Integer | FK | 作成者のユーザーID       |\n| created_at    | Timestamp   |    | 作成日時         |\n| updated_at    | Timestamp   |    | 更新日時         |\n\n## 3. エンティティ間関連性 (リレーションシップ)\n\n主要なエンティティ間の関連性を定義します。\n\n*   **User** (1) --- (*) **Case**: 1人のユーザーは複数の案件を作成または担当する。\n*   **Customer** (1) --- (*) **Case**: 1つの顧客に対して複数の案件が存在する。\n*   **Partner** (1) --- (*) **Case**: 1つの提携企業に対して複数の案件が存在する場合がある (任意)。\n*   **Case** (1) --- (*) **Document**: 1つの案件に複数の書類が関連付けられる。\n*   **Case** (0..1) --- (*) **Schedule**: 1つの案件に複数のスケジュールが関連付けられる場合がある。\n*   **Customer** (0..1) --- (*) **Schedule**: 1つの顧客に複数のスケジュールが関連付けられる場合がある。\n*   **User** (1) --- (*) **Schedule**: 1人のユーザーが複数のスケジュールを作成する。\n\n*記法: (多重度) エンティティA --- 関連性 --- エンティティB (多重度)*\n*多重度例: (1) 厳密に1, (*) 0以上, (0..1) 0または1*\n\n## 4. 補足事項\n\n*   本データモデルは主要なエンティティに焦点を当てています。詳細設計においては、中間テーブルやより細かい属性の定義が必要になります。\n*   UUIDはユニバーサルに一意なID、IntegerはシーケンシャルなIDを想定しています。どちらを採用するかは実装時に決定します。\n*   Enumは列挙型を示し、括弧内に具体的な値を例示しています。実際のシステムではコードで定義されます。\n*   JSON/Stringは構造化されたデータを文字列として保持する可能性があることを示します。 