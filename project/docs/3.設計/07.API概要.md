# ES業務フロー API概要

## 1. はじめに

この文書は、ES業務フローシステムのバックエンドが提供するAPIの概要を示すものです。主にフロントエンドとの連携、および将来的な外部システム連携を想定しています。個別のAPIエンドポイントの詳細はこの文書には含めず、別途API仕様書として管理します。

## 2. 設計方針

*   **API形式:** RESTful API を採用することを基本とします。
*   **データ形式:** リクエスト、レスポンスのデータ形式はJSONを使用します。
*   **認証:** すべての認証が必要なAPIリクエストには、認証トークン（例: JWT）を付与することを必須とします。
*   **認可:** 各APIエンドポイントでは、リクエストを行ったユーザーがその操作を実行する権限を持っているか検証します。
*   **エラーハンドリング:** 標準的なHTTPステータスコードを使用し、エラー発生時は詳細な情報をレスポンスボディに含めます。
*   **バージョン管理:** APIの変更に対応できるよう、バージョン管理の仕組み（例: URLにv1, v2を含める）を導入することを検討します。

## 3. 主要APIカテゴリ

データエンティティや機能要件に基づき、以下の主要なAPIカテゴリが考えられます。

*   **認証・認可API:** ログイン、ログアウト、ユーザー情報の取得、パスワード変更（初期パスワード変更含む）など。
*   **顧客管理API:** オーナー、不動産会社/管理会社の登録、参照、更新、削除。関連情報の取得（物件一覧、案件一覧など）。
*   **業務提携管理API:** 業務提携情報の登録、参照、更新、削除。
*   **物件管理API:** 物件情報の登録、参照、更新、削除。
*   **案件管理API:** 案件の登録、参照、更新、削除。ステータス変更。関連情報の取得（調査記録、報告記録、書類一覧など）。
*   **書類作成・管理API:** 見積書、契約書の作成、参照、更新、削除。明細の管理。承認依頼、承認処理。
*   **スケジュール管理API:** アポイント、施工日程の登録、参照、更新、削除。
*   **本部確認API:** お客様確認対象案件の参照、お客様確認結果の登録/更新。
*   **マスタデータAPI:** 工事種別マスタなどの参照。
*   **ユーザー管理API (管理者向け):** ユーザーの登録、参照、更新、削除。役割の管理。
*   **ファイルアップロードAPI:** 調査写真などのファイルをアップロードするためのAPI。

## 4. 今後の詳細化

*   各APIカテゴリにおける具体的なエンドポイント（URLパス、HTTPメソッド）の定義。
*   各エンドポイントにおけるリクエストパラメータ、リクエストボディ、レスポンスボディの詳細な定義。
*   エラーレスポンスの具体的な形式定義。
*   レート制限やキャッシュ戦略などの検討。
*   API仕様書の作成（Swagger/OpenAPIなどのツール利用を検討）。 